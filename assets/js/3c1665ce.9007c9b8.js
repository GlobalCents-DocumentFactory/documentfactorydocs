"use strict";(self.webpackChunkdocumentfactorydocs=self.webpackChunkdocumentfactorydocs||[]).push([[6911],{166:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>a});var s=r(4848),i=r(8453),t=r(8774);const l={sidebar_position:12,title:"Merge Metadata",toc_min_heading_level:2,toc_max_heading_level:5},c="Merge Metadata",o={id:"pipeline/merge_meta",title:"Merge Metadata",description:"The Merge Metadata action in DocumentFactory allows dynamic replacement of document property tags with their actual values.",source:"@site/docs/pipeline/merge_meta.mdx",sourceDirName:"pipeline",slug:"/pipeline/merge_meta",permalink:"/documentfactorydocs/docs/pipeline/merge_meta",draft:!1,unlisted:!1,editUrl:"https://github.com/GlobalCents-DocumentFactory/documentfactorydocs/tree/main/docs/pipeline/merge_meta.mdx",tags:[],version:"current",sidebarPosition:12,frontMatter:{sidebar_position:12,title:"Merge Metadata",toc_min_heading_level:2,toc_max_heading_level:5},sidebar:"tutorialSidebar",previous:{title:"Secure PDF",permalink:"/documentfactorydocs/docs/pipeline/secure"},next:{title:"Client Tools",permalink:"/documentfactorydocs/docs/category/client-tools"}},d={},a=[{value:"Properties",id:"properties",level:2},{value:"<code>actionmergemeta</code>",id:"actionmergemeta",level:3},{value:"<code>settingsmergemeta</code>",id:"settingsmergemeta",level:3},{value:"<code>usestrictreplacement</code>",id:"usestrictreplacement",level:4},{value:"<code>mergenullorempty</code>",id:"mergenullorempty",level:4},{value:"<code>removeemptylines</code>",id:"removeemptylines",level:4},{value:"<code>wordtrackchanges</code>",id:"wordtrackchanges",level:4},{value:"Fluid integration",id:"fluid-integration",level:2},{value:"Basic Fluid capabilities",id:"basic-fluid-capabilities",level:3},{value:"Variable replacement",id:"variable-replacement",level:4},{value:"Conditionals",id:"conditionals",level:4},{value:"Loops",id:"loops",level:4},{value:"Filters",id:"filters",level:4},{value:"Supported formats",id:"supported-formats",level:2},{value:"Built-in document properties (examples)",id:"built-in-document-properties-examples",level:3},{value:"Custom properties",id:"custom-properties",level:3},{value:"Example",id:"example",level:2}];function p(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"merge-metadata",children:"Merge Metadata"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"Merge Metadata"})," action in DocumentFactory allows dynamic replacement of document property tags with their actual values.\nThis action is particularly useful for scenarios where metadata-driven customization is required, such as generating personalized reports,\ncontracts, or document templates. By combining metadata with document templates, organizations can streamline workflows\nand ensure consistent, accurate output across multiple formats."]}),"\n",(0,s.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsx)(n.h3,{id:"actionmergemeta",children:(0,s.jsx)(n.code,{children:"actionmergemeta"})}),"\n",(0,s.jsxs)(n.p,{children:["Type: ",(0,s.jsx)("code",{style:{color:"#0066cc"},children:"boolean"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"actionmergemeta"})," setting activates the metadata merge feature within the processing pipeline. When set to ",(0,s.jsx)(n.code,{children:"true"}),"\nwithin the ",(0,s.jsx)(n.code,{children:"processors"})," or ",(0,s.jsx)(n.code,{children:"postprocessors"})," arrays, the system will process tags within supported documents and replace\nthem with their corresponding property values."]}),"\n",(0,s.jsx)(n.h3,{id:"settingsmergemeta",children:(0,s.jsx)(n.code,{children:"settingsmergemeta"})}),"\n",(0,s.jsxs)(n.p,{children:["Type: ",(0,s.jsx)("code",{style:{color:"#0066cc"},children:"object"})]}),"\n",(0,s.jsxs)(n.p,{children:["Additionally, the ",(0,s.jsx)(n.code,{children:"settingsmergemeta"})," object provides configuration parameters for the Merge Metadata action, ensuring flexible\nand precise control of the merge process."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"settingsmergemeta"})," property can contain the following properties:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(t.A,{to:"#usestrictreplacement",children:(0,s.jsx)(n.code,{children:"usestrictreplacement"})})," \u2013 Require exact property name matching."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(t.A,{to:"#mergenullorempty",children:(0,s.jsx)(n.code,{children:"mergenullorempty"})})," \u2013 Control merging of null or empty values."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(t.A,{to:"#removeemptylines",children:(0,s.jsx)(n.code,{children:"removeemptylines"})})," \u2013 Remove empty lines after replacement."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(t.A,{to:"#wordtrackchanges",children:(0,s.jsx)(n.code,{children:"wordtrackchanges"})})," \u2013 Respect Word\u2019s ",(0,s.jsx)(n.em,{children:"Track Changes"})," feature."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"usestrictreplacement",children:(0,s.jsx)(n.code,{children:"usestrictreplacement"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Type:"})," ",(0,s.jsx)("code",{style:{color:"#0066cc"},children:"boolean (default = false)"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"usestrictreplacement"})," property defines whether tag replacement must match property names exactly.\nWhen enabled (",(0,s.jsx)(n.code,{children:"true"}),"), only exact matches between tag names and document properties will be replaced.\nWhen disabled (",(0,s.jsx)(n.code,{children:"false"}),"), the system allows more flexible matching, which is useful if property names vary slightly across sources."]}),"\n",(0,s.jsx)(n.h4,{id:"mergenullorempty",children:(0,s.jsx)(n.code,{children:"mergenullorempty"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Type:"})," ",(0,s.jsx)("code",{style:{color:"#0066cc"},children:"boolean (default = false)"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"mergenullorempty"})," property determines how null or empty values are handled during replacement.\nIf it is set to ",(0,s.jsx)(n.code,{children:"true"}),", empty values are still merged into the document, which may leave visible blanks.\nIf it is left as ",(0,s.jsx)(n.code,{children:"false"}),", such values are ignored, and corresponding tags remain untouched."]}),"\n",(0,s.jsx)(n.h4,{id:"removeemptylines",children:(0,s.jsx)(n.code,{children:"removeemptylines"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Type:"})," ",(0,s.jsx)("code",{style:{color:"#0066cc"},children:"boolean (default = false)"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"removeemptylines"})," property specifies how the system treats empty lines after replacement.\nWhen the option is enabled, any extra whitespace or blank lines caused by missing values will be automatically removed,\nproducing cleaner output. If disabled, the original document formatting is preserved, even if some tags resolve to nothing."]}),"\n",(0,s.jsx)(n.h4,{id:"wordtrackchanges",children:(0,s.jsx)(n.code,{children:"wordtrackchanges"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Type:"})," ",(0,s.jsx)("code",{style:{color:"#0066cc"},children:"boolean (default = false)"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"wordtrackchanges"})," property applies only to ",(0,s.jsx)(n.strong,{children:"Word documents"}),".\nWhen this option is enabled, all replacements are inserted using Word\u2019s ",(0,s.jsx)(n.em,{children:"Track Changes"})," feature, allowing authors to review,\naccept, or reject modifications. When disabled, replacements are applied directly without tracking."]}),"\n",(0,s.jsx)(n.h2,{id:"fluid-integration",children:"Fluid integration"}),"\n",(0,s.jsxs)(n.p,{children:["DocumentFactory uses the ",(0,s.jsx)(n.a,{href:"https://github.com/sebastienros/fluid",children:"Fluid templating engine"})," to handle property tags inside documents.\nFluid is a high-performance, .NET-based templating engine inspired by ",(0,s.jsx)(n.a,{href:"https://shopify.github.io/liquid/",children:"Liquid"}),".\nIt allows defining placeholders (tags) in documents, which are dynamically replaced at runtime."]}),"\n",(0,s.jsxs)(n.p,{children:["All document properties are wrapped under the ",(0,s.jsx)(n.code,{children:"props"})," object."]}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"{{ props.Title }}\n{{ props.Author }}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"basic-fluid-capabilities",children:"Basic Fluid capabilities"}),"\n",(0,s.jsx)(n.h4,{id:"variable-replacement",children:"Variable replacement"}),"\n",(0,s.jsx)(n.p,{children:"Replace property tags with actual values.\nExample:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"{{ props.Title }} - Replaced with the document's title.\n"})}),"\n",(0,s.jsx)(n.h4,{id:"conditionals",children:"Conditionals"}),"\n",(0,s.jsx)(n.p,{children:"Control whether a section of content is included based on property values."}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:'{% if props.Status == "Approved" %}\n    This document is approved.\n{% else %}\n    This document is pending approval.\n{% endif %}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"loops",children:"Loops"}),"\n",(0,s.jsx)(n.p,{children:"Iterate over collections and dynamically insert rows or repeated content."}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"{% for item in props.Items %}\n    {{ item.Name }}: {{ item.Quantity }}\n{% endfor %}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"filters",children:"Filters"}),"\n",(0,s.jsx)(n.p,{children:"Transform values during rendering."}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:'{{ props.CreatedDate | date: "%Y-%m-%d" }}\n{{ props.Author | upcase }}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["For more advanced usage, please refer to the ",(0,s.jsx)(n.a,{href:"https://github.com/sebastienros/fluid",children:"official Fluid documentation"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"supported-formats",children:"Supported formats"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"MergeMeta"})," action works across multiple document formats:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"PDF"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Word (DOC, DOCX)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Excel (XLS, XLSX)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"PowerPoint (PPT, PPTX)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Visio (VSD, VSDX)"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"built-in-document-properties-examples",children:"Built-in document properties (examples)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Word / Excel / PowerPoint / Visio"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Title"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Subject"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Author"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Manager"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Company"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Category"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Keywords"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Comments"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.CreatedDate"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.LastSavedBy"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"PDF"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Title"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Author"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Subject"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Keywords"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Creator"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"props.Producer"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"custom-properties",children:"Custom properties"}),"\n",(0,s.jsxs)(n.p,{children:["Custom properties can be added for ",(0,s.jsx)(n.strong,{children:"Word, Excel, PowerPoint, and Visio"})," documents. These allow organizations to define\ntheir own metadata fields (e.g., ",(0,s.jsx)(n.code,{children:"ProjectCode"}),", ",(0,s.jsx)(n.code,{children:"CustomerName"}),") and use them directly in templates:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"{{ props.ProjectCode }}\n{{ props.CustomerName }}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="pipeline.json"',children:'{\n    "processors": [\n        {\n            "actionmergemeta": true,\n            "settingsmergemeta": {\n                "usestrictreplacement": false,\n                "mergenullorempty": false,\n                "removeemptylines": false,\n                "wordtrackchanges": false\n            }\n        }\n    ]\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>c});var s=r(6540);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);