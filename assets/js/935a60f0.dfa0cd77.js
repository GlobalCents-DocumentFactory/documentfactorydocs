"use strict";(self.webpackChunkdocumentfactorydocs=self.webpackChunkdocumentfactorydocs||[]).push([[3961],{1785:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>d,default:()=>j,frontMatter:()=>c,metadata:()=>l,toc:()=>h});var i=n(4848),s=n(8453),t=n(6025),o=n(530);const c={sidebar_position:2,title:"Monitoring with Prometheus"},d="Monitoring with Prometheus",l={id:"advanced-topics/minitoring",title:"Monitoring with Prometheus",description:"DocumentFactory exposes metrics in a format compatible with Prometheus, enabling integration with modern monitoring",source:"@site/docs/advanced-topics/minitoring.mdx",sourceDirName:"advanced-topics",slug:"/advanced-topics/minitoring",permalink:"/documentfactorydocs/docs/advanced-topics/minitoring",draft:!1,unlisted:!1,editUrl:"https://github.com/GlobalCents-DocumentFactory/documentfactorydocs/tree/main/docs/advanced-topics/minitoring.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Monitoring with Prometheus"},sidebar:"tutorialSidebar",previous:{title:"Error Handling & Logging",permalink:"/documentfactorydocs/docs/advanced-topics/errorhandling_and_logging"}},a={},h=[{value:"What is Prometheus?",id:"what-is-prometheus",level:2},{value:"Setting Up Prometheus to Monitor DocumentFactory",id:"setting-up-prometheus-to-monitor-documentfactory",level:2},{value:"DocumentFactory Metrics",id:"documentfactory-metrics",level:2},{value:"Service Info Metrics",id:"service-info-metrics",level:3},{value:"Workflow Metrics",id:"workflow-metrics",level:3},{value:"Label Definitions:",id:"label-definitions",level:4},{value:"Artifact Metrics",id:"artifact-metrics",level:3},{value:"Label Definitions",id:"label-definitions-1",level:4},{value:"Job Metrics",id:"job-metrics",level:3},{value:"Label Definitions",id:"label-definitions-2",level:4},{value:"Document Processor Metrics",id:"document-processor-metrics",level:3},{value:"Label Definitions",id:"label-definitions-3",level:4},{value:"Using Grafana to Visualize Metrics",id:"using-grafana-to-visualize-metrics",level:2}];function x(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"monitoring-with-prometheus",children:"Monitoring with Prometheus"})}),"\n",(0,i.jsxs)(r.p,{children:["DocumentFactory exposes metrics in a format compatible with ",(0,i.jsx)(r.a,{href:"https://prometheus.io/",children:(0,i.jsx)(r.strong,{children:"Prometheus"})}),", enabling integration with modern monitoring\nand alerting systems."]}),"\n",(0,i.jsx)(r.h2,{id:"what-is-prometheus",children:"What is Prometheus?"}),"\n",(0,i.jsx)(r.p,{children:"Prometheus is an open-source monitoring and alerting toolkit designed for reliability and scalability. It collects metrics\nfrom configured targets at given intervals, stores them efficiently, and allows powerful queries using the PromQL language.\nPrometheus is widely used for observing application performance, resource usage, and system behavior in real time."}),"\n",(0,i.jsx)(r.h2,{id:"setting-up-prometheus-to-monitor-documentfactory",children:"Setting Up Prometheus to Monitor DocumentFactory"}),"\n",(0,i.jsx)(r.p,{children:"To collect and view DocumentFactory metrics, install Prometheus and configure it to scrape the metrics endpoint exposed\nby the application."}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Basic steps:"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Install Prometheus"})," on your infrastructure. (Instructions and downloads are available in the official\n",(0,i.jsx)(r.a,{href:"https://prometheus.io/docs/introduction/overview/",children:(0,i.jsx)(r.strong,{children:"Prometheus documentation"})}),".)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Add a scrape job"})," for DocumentFactory in your ",(0,i.jsx)(r.code,{children:"prometheus.yml"})," configuration file, pointing to the /metrics endpoint (on port 5123)."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Restart Prometheus"})," to apply the new configuration."]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"documentfactory-metrics",children:"DocumentFactory Metrics"}),"\n",(0,i.jsx)(r.p,{children:"The DocumentFactory exposes internal metrics via the Prometheus-compatible HTTP endpoint:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-txt",children:"http://<host>:5123/metrics\n"})}),"\n",(0,i.jsxs)(r.admonition,{type:"note",children:[(0,i.jsx)(r.p,{children:"On Windows, you may need to grant explicit permissions for the HTTP listener if running as a non-administrator or as a service user.\nThis is accomplished using the netsh command:"}),(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-powershell",children:"netsh http add urlacl url=http://+:5123/metrics user=YOUR-DOMAIN\\YourUser\n"})})]}),"\n",(0,i.jsx)(r.h3,{id:"service-info-metrics",children:"Service Info Metrics"}),"\n",(0,i.jsx)(r.p,{children:"Exposes static information about the application, including the .NET version, application name, and version."}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Metric Name"}),(0,i.jsx)(r.th,{children:"Type"}),(0,i.jsx)(r.th,{children:"Labels"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsx)(r.tbody,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfdservice_info"})}),(0,i.jsx)(r.td,{children:"Gauge"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"dotnet_version"}),", ",(0,i.jsx)(r.code,{children:"app_name"}),", ",(0,i.jsx)(r.code,{children:"app_version"})]}),(0,i.jsxs)(r.td,{children:["Exposes static application info; value is always set to ",(0,i.jsx)(r.code,{children:"1"}),"."]})]})})]}),"\n",(0,i.jsx)(r.h3,{id:"workflow-metrics",children:"Workflow Metrics"}),"\n",(0,i.jsx)(r.p,{children:"Metrics related to workflow executions."}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Metric Name"}),(0,i.jsx)(r.th,{children:"Type"}),(0,i.jsx)(r.th,{children:"Labels"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_workflow_counter"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"workflow_type"})}),(0,i.jsx)(r.td,{children:"Counts total number of workflow executions."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_workflow_errors"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"workflow_type"})}),(0,i.jsx)(r.td,{children:"Counts number of workflows that resulted in error."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_workflow_latency"})}),(0,i.jsx)(r.td,{children:"Summary"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"workflow_type"})}),(0,i.jsx)(r.td,{children:"Measures workflow execution latency (in ms)."})]})]})]}),"\n",(0,i.jsx)(r.h4,{id:"label-definitions",children:"Label Definitions:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"workflow_type"})," \u2013 Type of workflow (",(0,i.jsx)(r.code,{children:"Standard"})," is currently the only value used)."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"artifact-metrics",children:"Artifact Metrics"}),"\n",(0,i.jsx)(r.p,{children:"Metrics related to artifact creation or processing."}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Metric Name"}),(0,i.jsx)(r.th,{children:"Type"}),(0,i.jsx)(r.th,{children:"Labels"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_artifact_counter"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"artifact_type"}),", ",(0,i.jsx)(r.code,{children:"artifact_action"})]}),(0,i.jsx)(r.td,{children:"Counts total number of artifact operations."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_artifact_errors"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"artifact_type"}),", ",(0,i.jsx)(r.code,{children:"artifact_action"})]}),(0,i.jsx)(r.td,{children:"Counts number of artifact-related errors."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_artifact_latency"})}),(0,i.jsx)(r.td,{children:"Summary"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"artifact_type"}),", ",(0,i.jsx)(r.code,{children:"artifact_action"})]}),(0,i.jsx)(r.td,{children:"Measures artifact processing latency (in ms)."})]})]})]}),"\n",(0,i.jsx)(r.h4,{id:"label-definitions-1",children:"Label Definitions"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"artifact_type"})," \u2013 Type of storage used for the artifact (e.g., ",(0,i.jsx)(r.code,{children:"nuts"}),", ",(0,i.jsx)(r.code,{children:"s3"}),", ",(0,i.jsx)(r.code,{children:"fs"}),")."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"artifact_action"})," \u2013 Type of operation performed: ",(0,i.jsx)(r.code,{children:"upload"})," or ",(0,i.jsx)(r.code,{children:"download"}),"."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"job-metrics",children:"Job Metrics"}),"\n",(0,i.jsx)(r.p,{children:"Metrics related to job execution, categorized by job and processor types."}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Metric Name"}),(0,i.jsx)(r.th,{children:"Type"}),(0,i.jsx)(r.th,{children:"Labels"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_job_counter"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"job_type"}),", ",(0,i.jsx)(r.code,{children:"job_processortype"})]}),(0,i.jsx)(r.td,{children:"Counts total number of job executions."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_job_errors"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"job_type"}),", ",(0,i.jsx)(r.code,{children:"job_processortype"})]}),(0,i.jsx)(r.td,{children:"Counts number of jobs that resulted in an error."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_job_latency"})}),(0,i.jsx)(r.td,{children:"Summary"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"job_type"}),", ",(0,i.jsx)(r.code,{children:"job_processortype"})]}),(0,i.jsx)(r.td,{children:"Measures job execution latency (in ms)."})]})]})]}),"\n",(0,i.jsx)(r.h4,{id:"label-definitions-2",children:"Label Definitions"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"job_type"})," \u2013 Processing stage of the job, e.g., ",(0,i.jsx)(r.code,{children:"Preprocess"}),", ",(0,i.jsx)(r.code,{children:"Postprocess"}),", ",(0,i.jsx)(r.code,{children:"Merge"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"job_processortype"})," \u2013 Name of the processor handling the document, e.g., ",(0,i.jsx)(r.code,{children:"pdf"}),", ",(0,i.jsx)(r.code,{children:"word"}),", ",(0,i.jsx)(r.code,{children:"image"}),"."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"document-processor-metrics",children:"Document Processor Metrics"}),"\n",(0,i.jsx)(r.p,{children:"Metrics related to document processing operations."}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Metric Name"}),(0,i.jsx)(r.th,{children:"Type"}),(0,i.jsx)(r.th,{children:"Labels"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_docprocessor_counter"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"processor_type"}),", ",(0,i.jsx)(r.code,{children:"processor_action"})]}),(0,i.jsx)(r.td,{children:"Counts total number of document processor operations."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_docprocessor_errors"})}),(0,i.jsx)(r.td,{children:"Counter"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"processor_type"}),", ",(0,i.jsx)(r.code,{children:"processor_action"})]}),(0,i.jsx)(r.td,{children:"Counts number of document processor errors."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"ptfd_docprocessor_latency"})}),(0,i.jsx)(r.td,{children:"Summary"}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"processor_type"}),", ",(0,i.jsx)(r.code,{children:"processor_action"})]}),(0,i.jsx)(r.td,{children:"Measures document processor latency (in ms)."})]})]})]}),"\n",(0,i.jsx)(r.h4,{id:"label-definitions-3",children:"Label Definitions"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"processor_type"})," \u2013 Type of the processor handling the document (e.g., ",(0,i.jsx)(r.code,{children:"pdf"}),", ",(0,i.jsx)(r.code,{children:"word"}),", ",(0,i.jsx)(r.code,{children:"image"}),")."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"processor_action"})," \u2013 The action performed by the processor, such as ",(0,i.jsx)(r.code,{children:"merge"}),", ",(0,i.jsx)(r.code,{children:"convert"}),", or ",(0,i.jsx)(r.code,{children:"watermark"}),"."]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"using-grafana-to-visualize-metrics",children:"Using Grafana to Visualize Metrics"}),"\n",(0,i.jsx)(r.p,{children:"Grafana is an open-source analytics and dashboard platform that provides powerful visualization capabilities for DocumentFactory metrics."}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"To view and analyze metrics:"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["Install Grafana by following the official ",(0,i.jsx)(r.a,{href:"https://grafana.com/get/",children:(0,i.jsx)(r.strong,{children:"Grafana documentation"})}),"."]}),"\n",(0,i.jsx)(r.li,{children:"Add Prometheus as a data source in Grafana."}),"\n",(0,i.jsx)(r.li,{children:"Create dashboards to display key DocumentFactory metrics as charts, tables, and indicators."}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"Grafana dashboards can be used to monitor system health, workflow performance, error rates, and latency, utilizing\nvisualization options such as time series graphs, gauges, and tables."}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Basic workflow for dashboard creation:"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["In the Grafana interface, ",(0,i.jsx)(r.strong,{children:"select \u201c+\u201d \u2192 \u201cDashboard\u201d"})," and add panels with the necessary metrics."]}),"\n",(0,i.jsx)(r.li,{children:"For each panel, specify Prometheus as the data source and enter the appropriate PromQL queries for the metrics to be displayed."}),"\n",(0,i.jsx)(r.li,{children:"Panels can be arranged and customized to meet specific monitoring needs."}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"A ready-to-use dashboard JSON file, containing sample panels for DocumentFactory metrics, is available:"}),"\n",(0,i.jsx)("a",{href:(0,t.Ay)("/files/grafana-dashboard.json"),download:!0,children:(0,i.jsx)(r.p,{children:"Download Grafana dashboard JSON"})}),"\n",(0,i.jsxs)(r.p,{children:["This file can be imported in Grafana via ",(0,i.jsx)(r.strong,{children:"\u201cDashboards\u201d \u2192 \u201cImport\u201d"}),"."]}),"\n",(0,i.jsx)(r.p,{children:"Below is a screenshot illustrating the example dashboard:"}),"\n",(0,i.jsx)(o.A,{src:"monitoring/grafana_dashboard.png",alt:"DF config location",maxWidth:"800px"}),"\n",(0,i.jsx)(r.p,{children:"Dashboards and panels can be further edited to provide a more convenient or unique view, depending on project or team requirements."}),"\n",(0,i.jsxs)(r.p,{children:["For more details on customization and advanced configuration, refer to the ",(0,i.jsx)(r.a,{href:"https://grafana.com/docs/",children:(0,i.jsx)(r.strong,{children:"Grafana documentation"})}),"."]})]})}function j(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}},530:(e,r,n)=>{n.d(r,{A:()=>t});n(6540);var i=n(6025),s=n(4848);function t(e){let{src:r,alt:n,width:t="100%",maxWidth:o="600px"}=e;return(0,s.jsx)("img",{src:(0,i.Ay)(`/img/${r}`),alt:n,style:{display:"block",margin:"auto",width:t,maxWidth:o}})}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>c});var i=n(6540);const s={},t=i.createContext(s);function o(e){const r=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(t.Provider,{value:r},e.children)}}}]);